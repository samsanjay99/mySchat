services:
  # Main Web Service (Docker)
  - type: web
    name: schat-app
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    plan: free
    region: oregon
    branch: main
    
    # Environment variables (used at build time and runtime)
    envVars:
      - key: NODE_ENV
        value: production
      
      - key: PORT
        value: 3001
      
      # Database (use your actual database URL)
      - key: DATABASE_URL
        sync: false
      
      # JWT Secret
      - key: JWT_SECRET
        generateValue: true
      
      # A4F API Configuration
      - key: A4F_API_KEY
        value: ddc-a4f-73b259b67d954d5087f48319b7673747
      
      - key: A4F_BASE_URL
        value: https://api.a4f.co/v1
      
      # Admin Configuration
      - key: ADMIN_EMAIL
        value: admin@schat.com
      
      - key: ADMIN_PASSWORD
        sync: false
      
      - key: ADMIN_FULL_NAME
        value: System Administrator
      
      # Firebase Configuration - REQUIRED at build time for Vite
      - key: VITE_FIREBASE_API_KEY
        value: AIzaSyByfnkkszDUWWG2q-ukrw2CxNrLMQu4W54
      
      - key: VITE_FIREBASE_AUTH_DOMAIN
        value: hellochat-99.firebaseapp.com
      
      - key: VITE_FIREBASE_PROJECT_ID
        value: hellochat-99
      
      - key: VITE_FIREBASE_STORAGE_BUCKET
        value: hellochat-99.firebasestorage.app
      
      - key: VITE_FIREBASE_MESSAGING_SENDER_ID
        value: "963414169504"
      
      - key: VITE_FIREBASE_APP_ID
        value: 1:963414169504:web:6594f77e74be5f8f73b6c5
      
      - key: VITE_FIREBASE_MEASUREMENT_ID
        value: G-PSBP598P39
    
    # Health check endpoint
    healthCheckPath: /api/health
    
    # Auto-deploy on push
    autoDeploy: true
    
    # Build command (Docker handles this)
    # No buildCommand needed for Docker
    
    # Start command (Docker handles this)
    # No startCommand needed for Docker

# Database
databases:
  - name: schat-db
    databaseName: schat
    user: schat_user
    plan: free
    region: oregon
